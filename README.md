# 자동완성 방법
- 상권 검색어 추천 인덱스: 색인과 검색시, n-gram 분석기
- 게시판 검색어 추천 인덱스: 색인시, nori 분석기 / 검색시, n-gram 분석기
  - 색인 시 nori_analyzer를 사용하여 텍스트를 의미 단위로 나누어 저장하고, 검색 시 ngram_analyzer를 사용하면 부분 검색과 의미 단위 검색을 혼합할 수 있습니다.
  - 예: "서울에 갔다"라는 문장을 색인할 때 Nori 분석기로 나누면 "서울", "가다"로 나누어 저장되고, 검색할 때 n-gram 분석기를 사용하면 "서" 또는 "서울"만 입력해도 해당 문서를 검색할 수 있습니다.

## N-gram 을 이용한 자동완성

상권이나 프랜차이즈명과 같은 경우는 중간 단어만 기억나거나 중간 단어가 핵심인 경우가 상당수 있으므로   
접두사 기반 Edge N-gram보다 N-gram이 적합하다고 판단.


## 비교
- Edge N-gram

min_gram: 토큰의 최소 길이 (접두사 길이)  
max_gram: 토큰의 최대 길이  
접두사 기반으로 빠르고 효율적인 자동완성 구현에 적합  

- N-gram

min_gram: 토큰의 최소 길이 (부분 텍스트 길이)  
max_gram: 토큰의 최대 길이  
텍스트 중간 부분도 검색 가능하므로 복잡한 검색에 유리하지만, 인덱스 크기와 성능에 부담이 될 수 있음  



### 인덱스 수정 방법
1. 임시 인덱스 생성
2. 현재 인덱스 데이터 임시 인덱스로 이동
3. 현재 인덱스 삭제
4. 새로운 인덱스 생성
5. 임시인덱스 데이터 새로운 인덱스로 이동
6. 임시 인덱스 삭제

# 개념
## 색인(Indexing)이란?
색인 과정은 데이터를 Elasticsearch에 저장하는 과정입니다. 이때 **색인 분석기(analyzer)**는 데이터를 어떻게 저장할지를 결정합니다.  
색인 시: 문서를 Elasticsearch에 넣을 때, 분석기가 데이터를 처리하여 토큰(단어 단위)으로 나누고, 이 토큰들이 인덱스에 저장됩니다.  
예를 들어, 서울이라는 단어를 n-gram 분석기로 색인하면 서, 서울, 울과 같은 토큰들이 저장됩니다.  

## 검색(Search)이란?
검색 과정은 사용자가 Elasticsearch에 쿼리를 보낼 때, 해당 쿼리를 분석하고 결과를 반환하는 과정입니다. **검색 분석기(search_analyzer)**는 쿼리(검색어)를 어떻게 처리할지를 결정합니다.  
검색 시: 사용자가 검색어를 입력하면, 이 검색어는 검색 분석기에 의해 처리됩니다. 분석된 검색어는 색인된 토큰들과 비교되어 검색 결과가 반환됩니다.  
예를 들어, 서울을 검색하면 검색어도 동일한 방식으로 나누어져 저장된 토큰과 매칭됩니다.  

## 분석기
| **특징**              | **nori 분석기**                                                                                       | **n-gram 분석기**                                                                                 |
|-----------------------|-------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| **주요 목적**          | 한국어와 같은 형태소 기반 언어를 위한 의미 단위 분석                                                   | 텍스트를 문자 단위로 잘라서 부분 검색 가능                                                       |
| **색인 시 역할**       | 텍스트를 **형태소(의미 단위)**로 나누어 저장 (예: "서울에 갔다" -> "서울", "가다")                     | 텍스트를 n개의 문자로 잘라서 저장 (예: "서울" -> "서", "서울", "울")                              |
| **검색 시 역할**       | 사용자의 검색어를 형태소 단위로 분리하여 검색 (예: "갔다" 검색 -> "가다" 포함 문서 검색 가능)            | 사용자가 입력한 검색어의 일부만으로도 검색 가능 (예: "서" 검색 -> "서울" 문서 검색 가능)           |
| **주 사용 예**         | 의미 단위로 검색이 필요한 경우 (예: 뉴스 기사 검색, 긴 텍스트 분석)                                    | 자동 완성, 부분 검색, 연관 검색이 필요한 경우 (예: 검색어 자동완성, 검색어 일부 입력)              |
| **단점**               | 형태소 분석이기 때문에 짧은 자음/모음 검색에는 적합하지 않음                                           | 문자의 순서를 단순히 자르기 때문에 의미 단위로는 분석하지 않음                                  |
| **장점**               | 한국어와 같이 어미가 변하는 언어에서 의미 있는 검색이 가능                                              | 자음/모음 단위로 검색이 가능해 사용자가 불완전한 검색어를 입력해도 관련 문서를 검색할 수 있음     |

# 결과 
검색시 n-gram 분석기
